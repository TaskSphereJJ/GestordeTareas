@model GestordeTaras.EN.Usuario

<h1 class="text-3xl font-bold mb-6 text-gray-900 dark:text-white">Mi Perfil</h1>

@await Html.PartialAsync("_AlertMessages")

<!-- Botón para activar el modo de edición -->
<button id="editProfileBtn" class="px-4 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-700 transition-all" onclick="toggleEditMode()">Editar Perfil</button>

<!-- Formulario de edición (oculto inicialmente) -->
<form id="profileForm" class="w-full mt-6" method="post" asp-action="Edit" style="display: none;">
    <input type="hidden" asp-for="Id" />
    
    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div class="flex flex-col">
            <label class="font-semibold text-gray-700 dark:text-gray-300">Nombre</label>
            <input type="text" asp-for="Nombre" class="mt-1 block w-full px-4 py-2 border rounded-lg shadow-sm focus:ring-purple-500 focus:border-purple-500 bg-gray-50 dark:bg-gray-700 dark:text-white" />
            <span asp-validation-for="Nombre" class="text-red-500 text-sm"></span>
        </div>

        <div class="flex flex-col">
            <label class="font-semibold text-gray-700 dark:text-gray-300">Apellido</label>
            <input type="text" asp-for="Apellido" class="mt-1 block w-full px-4 py-2 border rounded-lg shadow-sm focus:ring-purple-500 focus:border-purple-500 bg-gray-50 dark:bg-gray-700 dark:text-white" />
            <span asp-validation-for="Apellido" class="text-red-500 text-sm"></span>
        </div>

        <div class="flex flex-col">
            <label class="font-semibold text-gray-700 dark:text-gray-300">Correo Electrónico</label>
            <input type="text" asp-for="NombreUsuario" class="mt-1 block w-full px-4 py-2 border rounded-lg shadow-sm focus:ring-purple-500 focus:border-purple-500 bg-gray-50 dark:bg-gray-700 dark:text-white" />
            <span asp-validation-for="NombreUsuario" class="text-red-500 text-sm"></span>
        </div>

        <div class="flex flex-col">
            <label class="font-semibold text-gray-700 dark:text-gray-300">Contraseña</label>
            <input type="password" asp-for="Pass" class="mt-1 block w-full px-4 py-2 border rounded-lg shadow-sm focus:ring-purple-500 focus:border-purple-500 bg-gray-50 dark:bg-gray-700 dark:text-white" />
            <span asp-validation-for="Pass" class="text-red-500 text-sm"></span>
        </div>

        <div class="flex flex-col">
            <label class="font-semibold text-gray-700 dark:text-gray-300">Teléfono</label>
            <input type="text" asp-for="Telefono" class="mt-1 block w-full px-4 py-2 border rounded-lg shadow-sm focus:ring-purple-500 focus:border-purple-500 bg-gray-50 dark:bg-gray-700 dark:text-white" />
            <span asp-validation-for="Telefono" class="text-red-500 text-sm"></span>
        </div>

        <div class="flex flex-col">
            @if (User.IsInRole("Administrador"))
            {
                <label class="font-semibold text-gray-700 dark:text-gray-300">Cargo</label>
                <input type="text" asp-for="Cargo.Nombre" class="mt-1 block w-full px-4 py-2 border rounded-lg shadow-sm focus:ring-purple-500 focus:border-purple-500 bg-gray-50 dark:bg-gray-700 dark:text-white" />
            }
            else
            {
                <label class="font-semibold text-gray-700 dark:text-gray-300">Cargo</label>
                <p class="mt-1 px-4 py-2 bg-gray-50 dark:bg-gray-700 dark:text-white rounded-lg">@Html.DisplayFor(model => model.Cargo.Nombre)</p>
            }
        </div>

        <div class="flex flex-col">
            <label class="font-semibold text-gray-700 dark:text-gray-300">Fecha de Nacimiento</label>
            <input type="date" asp-for="FechaNacimiento" class="mt-1 block w-full px-4 py-2 border rounded-lg shadow-sm focus:ring-purple-500 focus:border-purple-500 bg-gray-50 dark:bg-gray-700 dark:text-white" value="@Model.FechaNacimiento.ToString("yyyy-MM-dd")" />
            <span asp-validation-for="FechaNacimiento" class="text-red-500 text-sm"></span>
        </div>
    </div>

    <div class="flex justify-end space-x-4 mt-6">
        <button type="submit" class="px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-700">Guardar Cambios</button>
        <button type="button" class="px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-700" onclick="toggleEditMode()">Cancelar</button>
    </div>
</form>

<!-- Vista de perfil sin edición -->
<div id="profileDisplay" class="w-full mt-6">
    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div>
            <label class="font-semibold text-gray-700 dark:text-gray-300">Nombre</label>
            <p class="px-4 py-2 bg-gray-50 dark:bg-gray-700 dark:text-white rounded-lg">@Html.DisplayFor(model => model.Nombre)</p>
        </div>
        <div>
            <label class="font-semibold text-gray-700 dark:text-gray-300">Apellido</label>
            <p class="px-4 py-2 bg-gray-50 dark:bg-gray-700 dark:text-white rounded-lg">@Html.DisplayFor(model => model.Apellido)</p>
        </div>

        <div>
            <label class="font-semibold text-gray-700 dark:text-gray-300">Correo Electrónico</label>
            <p class="px-4 py-2 bg-gray-50 dark:bg-gray-700 dark:text-white rounded-lg">@Html.DisplayFor(model => model.NombreUsuario)</p>
        </div>

        <div>
            <label class="font-semibold text-gray-700 dark:text-gray-300">Teléfono</label>
            <p class="px-4 py-2 bg-gray-50 dark:bg-gray-700 dark:text-white rounded-lg">@Html.DisplayFor(model => model.Telefono)</p>
        </div>

        <div>
            <label class="font-semibold text-gray-700 dark:text-gray-300">Cargo</label>
            <p class="px-4 py-2 bg-gray-50 dark:bg-gray-700 dark:text-white rounded-lg">@Html.DisplayFor(model => model.Cargo.Nombre)</p>
        </div>

        <div>
            <label class="font-semibold text-gray-700 dark:text-gray-300">Fecha de Nacimiento</label>
            <p class="px-4 py-2 bg-gray-50 dark:bg-gray-700 dark:text-white rounded-lg">@Html.DisplayFor(model => model.FechaNacimiento)</p>
        </div>

        <div>
            <label class="font-semibold text-gray-700 dark:text-gray-300">Fecha de Registro</label>
            <p class="px-4 py-2 bg-gray-50 dark:bg-gray-700 dark:text-white rounded-lg">@Html.DisplayFor(model => model.FechaRegistro)</p>
        </div>
    </div>
</div>

<script>
    function toggleEditMode() {
        const profileForm = document.getElementById('profileForm');
        const profileDisplay = document.getElementById('profileDisplay');
        const editButton = document.getElementById('editProfileBtn');

        if (profileForm.style.display === 'none') {
            profileForm.style.display = 'block';
            profileDisplay.style.display = 'none';
            editButton.style.display = 'none';
        } else {
            profileForm.style.display = 'none';
            profileDisplay.style.display = 'block';
            editButton.style.display = 'inline-block';
        }
    }
</script>
