@model GestordeTaras.EN.Usuario

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css"
    integrity="sha512-rfwlPRxWExv5sf0pd4l71r5Id3vYkQIm0IaOH1VlqzLX8ASwbS7qHwXy1Fm5zH4JAr6Drl7HDe5Kr1yzE+yyCg=="
    crossorigin="anonymous" />

<div class="contenedor">

    <!-- Vista de solo lectura -->
    <div id="profileDisplay" class="profile-layout">
        <!-- Columna de Foto -->
        <div class="photo-container">
            <div class="profile-photo-container">
                <img src="@Url.Content(Model.FotoPerfil)" alt="Foto de perfil" class="profile-photo" />
            </div>

            <!-- Info del Rol -->
            <div class="info-group @(
                Model.Cargo.Nombre == "Administrador" ? "rol-admin" :
                Model.Cargo.Nombre == "Colaborador" ? "rol-colaborador" :
                Model.Cargo.Nombre == "Encargado" ? "rol-encargado" : "")">
                <div class="info-value">@Model.Cargo.Nombre</div>
            </div>
        </div>

        <!-- Columna 1 y 2 de Información -->
        <div class="info-grid">
            <div class="info-group">
                <div class="info-label"><i class="fas fa-user"></i> Nombre</div>
                <div class="info-value">@Model.Nombre</div>
            </div>
            <div class="info-group">
                <div class="info-label"><i class="fas fa-user-tag"></i> Apellido</div>
                <div class="info-value">@Model.Apellido</div>
            </div>
            <div class="info-group">
                <div class="info-label"><i class="fas fa-envelope"></i> Correo Electrónico</div>
                <div class="info-value">@Model.NombreUsuario</div>
            </div>
            <div class="info-group">
                <div class="info-label"><i class="fas fa-phone-alt"></i> Teléfono</div>
                <div class="info-value">@Model.Telefono</div>
            </div>
            <div class="info-group">
                <div class="info-label"><i class="fas fa-calendar-alt"></i> Fecha de Nacimiento</div>
                <div class="info-value">@Model.FechaNacimiento.ToString("dd/MM/yyyy")</div>
            </div>
        </div>

        <!-- Botones de Acción -->
        <div class="actions">
            <button onclick="toggleEditMode()" class="btn btn-primary">
                <i class="fas fa-edit"></i> Editar Perfil
            </button>
            <button onclick="document.getElementById('confirmDeleteCard').classList.remove('hidden');"
                class="btn btn-danger">
                <i class="fas fa-trash-alt"></i> Eliminar Cuenta
            </button>
        </div>
    </div>

    <!-- Vista de edición -->
    <form id="profileForm" class="hidden" method="post" asp-action="EditOwn" enctype="multipart/form-data">
        <input type="hidden" asp-for="Id" />
        <div class="profile-layout">
            <!-- Columna de Foto -->
            <div class="photo-container">
                <div class="profile-photo-container">
                    <img id="previewImage" src="@Url.Content(Model.FotoPerfil)" alt="Foto de perfil"
                        class="profile-photo" />
                </div>
                <label for="fotoPerfil" class="photo-upload-label">
                    <i class="fas fa-camera"></i> Cambiar foto
                </label>
                <input type="file" id="fotoPerfil" name="FotoPerfil" accept="image/*" class="hidden"
                    onchange="previewFile()" />
            </div>

            <!-- Información Editable -->
            <div class="info-grid">
                <div class="form-group">
                    <label class="form-label"><i class="fas fa-user"></i> Nombre</label>
                    <input type="text" asp-for="Nombre" class="form-control" />
                    <span asp-validation-for="Nombre" class="validation-error"></span>
                </div>
                <div class="form-group">
                    <label class="form-label"><i class="fas fa-user-tag"></i> Apellido</label>
                    <input type="text" asp-for="Apellido" class="form-control" />
                    <span asp-validation-for="Apellido" class="validation-error"></span>
                </div>
                <div class="form-group">
                    <label class="form-label"><i class="fas fa-envelope"></i> Correo Electrónico</label>
                    <input type="text" asp-for="NombreUsuario" class="form-control" readonly />
                </div>
                <div class="form-group">
                    <label class="form-label"><i class="fas fa-phone-alt"></i> Teléfono</label>
                    <input type="text" asp-for="Telefono" class="form-control" />
                    <span asp-validation-for="Telefono" class="validation-error"></span>
                </div>
                <div class="form-group">
                    <label class="form-label"><i class="fas fa-briefcase"></i> Cargo</label>
                    <select asp-for="IdCargo" class="form-control" asp-items="ViewBag.Cargos">
                        <option value="">Seleccionar</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label"><i class="fas fa-calendar-alt"></i> Fecha de Nacimiento</label>
                    <input type="date" asp-for="FechaNacimiento" class="form-control"
                        value="@Model.FechaNacimiento.ToString("yyyy-MM-dd")" />
                    <span asp-validation-for="FechaNacimiento" class="validation-error"></span>
                </div>
            </div>

            <!-- Botones de Acción -->
            <div class="actions">
                <button type="submit" class="btn btn-primary">
                    <i class="fas fa-save"></i> Guardar
                </button>
                <button type="button" class="btn btn-secondary" onclick="toggleEditMode()">
                    <i class="fas fa-times"></i> Cancelar
                </button>
            </div>
        </div>
    </form>
</div>


<!-- Tarjeta de Confirmación -->
<div id="confirmDeleteCard"
    class="hidden fixed inset-0 flex items-center justify-center z-50 bg-gray-800 bg-opacity-60 transition-opacity duration-300">
    <div class="w-full max-w-sm mx-4 rounded-xl bg-white shadow-lg transform transition-all duration-300">
        <!-- Contenido de Confirmación -->
        <div class="p-6 text-center">
            <h2 class="text-xl font-semibold text-gray-900 mb-4">Confirmar Eliminación</h2>
            <p class="text-sm text-gray-500 mb-6">¿Estás seguro de que deseas eliminar tu cuenta? Esta acción no se
                puede deshacer.</p>
            <div class="flex justify-center space-x-4">
                <button type="button"
                    class="px-4 py-2 bg-gray-200 text-gray-700 font-medium rounded-lg hover:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-gray-400 focus:ring-opacity-75 transition duration-200"
                    onclick="document.getElementById('confirmDeleteCard').classList.add('hidden');">
                    Cancelar
                </button>
                <form method="post" asp-action="DeleteOwn">
                    <button type="submit"
                        class="px-4 py-2 bg-red-500 text-white font-semibold rounded-lg hover:bg-red-600 focus:outline-none focus:ring-2 focus:ring-red-400 focus:ring-opacity-75 transition duration-200">
                        Eliminar
                    </button>
                </form>
            </div>
        </div>
    </div>
</div>

<script>
    function toggleEditMode() {
        const profileForm = document.getElementById('profileForm');
        const profileDisplay = document.getElementById('profileDisplay');
        const editButton = document.getElementById('editProfileBtn');

        profileForm.classList.toggle('hidden');
        profileDisplay.classList.toggle('hidden');
        editButton.classList.toggle('hidden');
    }

    function previewFile() {
        var preview = document.getElementById('previewImage');
        var file = document.getElementById('fotoPerfil').files[0];
        var reader = new FileReader();

        reader.onloadend = function () {
            preview.src = reader.result;
        }

        if (file) {
            reader.readAsDataURL(file);
        } else {
            preview.src = "@Url.Content(Model.FotoPerfil)";
        }
    }
</script>